#include <stdio.h>
#include <math.h>

float x[100];
float XR[100];
float XI[100];
float b[51];
float y[100];
int N = 100;
float amplitude[100];
float amplitude1[100];
float phase[100];
float h[51] = {-0.03012856352907, 0.07518556094106, 0.0347107415489, 0.020773388533,
               0.01458846949463, 0.009901508624105, 0.004815070324426, -0.0009912477392302,
               0.007236113317258, -0.01328621421835, -0.01853229090741, -0.02212338859297,
               0.02350058075885, -0.02208352290888, -0.01748432902234, -0.009758034457342,
               0.001093534289564, 0.01455515002771, 0.02991549107912, 0.04627745357896,
               0.06270133716713, 0.07800956621943, 0.09121853292119, 0.1013742672991,
               0.10783870071, 0.1100289455531, 0.10783870071, 0.1013742672991,
               0.09121853292119, 0.07800956621943, 0.06270133716713, 0.04627745357896,
               0.02991549107912, 0.01455515002771, 0.001093534289564, -0.009758034457342,
               0.01748432902234, -0.02208352290888, -0.02350058075885, -0.02212338859297,
               0.01853229090741, -0.01328621421835, -0.007236113317258, -0.0009912477392302,
               0.004815070324426, 0.009901508624105, 0.01458846949463, 0.020773388533,
               0.0347107415489, 0.07518556094106, -0.03012856352907};

int main(void) {
    int i, j, k, n;

    for (i = 0; i < 100; i++) {
        x[i] = 5 + (2 * sin(2 * 3.14 * 30 * i / 100)) + (3 * cos(2 * 3.14 * 2 * i / 100));
    }

    for (j = 0; j < N; j++) {
        XR[j] = 0;
        XI[j] = 0;
        for (i = 0; i < N; i++) {
            XR[j] = XR[j] + (x[i] * cos(2 * 3.14 * i * j / N));
            XI[j] = XI[j] - (x[i] * sin(2 * 3.14 * i * j / N));
        }
    }

    for (i = 0; i < N; i++) {
        amplitude[i] = sqrt((XR[i] * XR[i]) + (XI[i] * XI[i]));
    }

    for (i = 0; i < 51; i++) {
        b[i] = 0.0;
    }

    for (n = 0; n < 100; n++) {
        for (i = 50; i > 0; i--) {
            b[i] = b[i - 1];
        }
        b[0] = x[n];

        y[n] = 0;
        for (i = 0; i < 51; i++) {
            y[n] = y[n] + (h[i] * b[i]);
        }
    }

    for (j = 0; j < N; j++) {
        XR[j] = 0;
        XI[j] = 0;
        for (i = 0; i < N; i++) {
            XR[j] = XR[j] + (y[i] * cos(2 * 3.14 * i * j / N));
            XI[j] = XI[j] - (y[i] * sin(2 * 3.14 * i * j / N));
        }
    }

    for (i = 0; i < N; i++) {
        amplitude1[i] = sqrt((XR[i] * XR[i]) + (XI[i] * XI[i]));
    }

    return 0;
}
